import numpy as np
import pandas as pd
import statsmodels.api as sm
from io import StringIO
data = """
등락률,거래대금,유통총액,전일대비거래량
+2.59,31051,3366041,1.5
+7.49,21345,1781172,0.9
-0.16,9239,267680,1.3
+9.52,7889,218457,4.6
+5.12,6506,15857,2.0
+4.12,5083,11491,0.8
+1.72,4865,319121,1.6
+0.27,4041,116284,0.8
+4.23,3700,209698,1.1
+29.83,3320,1553,4.9
+1.33,3107,38125,2.3
+1.77,3033,5000,2.9
+8.89,3031,3861,1.9
+6.50,2978,13275,0.8
-4.58,2646,52757,1.0
+2.53,2631,5396,2.0
+20.04,2591,10035,4.1
+9.29,2475,1276,0.9
-1.79,2298,146235,0.5
+23.84,2217,770,5.9
-0.60,2169,322707,0.5
+0.22,2124,302872,1.2
-5.55,2105,11007,0.7
+4.56,2092,21024,3.9
+15.29,1989,831,1.5
+1.17,1949,104464,0.7
+5.48,1942,19021,2.7
+8.13,1856,176535,1.3
+16.35,1832,839,20.3
+2.87,1801,118151,1.2
-1.74,1776,115367,1.3
+1.13,1694,4453,1.3
-3.62,1684,38711,1.0
+1.18,1569,155400,0.5
-1.60,1551,108103,1.1
+1.29,1505,145700,0.8
+11.83,1467,1828,7.1
+1.19,1437,360575,0.8
+3.68,1436,74839,0.9
+7.74,1418,12104,3.7
+1.53,1393,31275,1.1
+13.88,1375,1469,23.9
-2.55,1297,3002,0.9
+23.57,1266,736,428.6
-0.56,1226,249814,0.9
+1.77,1182,270316,0.7
-2.97,1178,8834,0.3
+1.84,1153,55424,0.5
+1.37,1149,131492,0.5
+29.89,1122,4140,8.1
+4.44,1109,8721,1.0
-2.55,1087,69931,0.4
+1.90,1074,30861,1.5
-2.87,1068,5815,0.6
+4.50,1060,746,5.1
+1.26,1059,158671,1.4
+9.85,1038,13814,3.7
+10.73,1031,17970,3.1
-1.89,1008,185497,0.8
+29.95,1007,1031,5.3
+1.14,974,216178,0.6
+1.60,971,187184,0.8
0.00,967,187247,0.8
+1.05,966,62726,0.9
+8.66,954,36727,4.1
-0.57,940,42005,0.4
-0.35,939,602,0.5
+0.77,936,14195,0.8
+2.39,913,19942,1.5
+0.37,888,39060,0.8
+2.84,875,34959,1.7
+4.89,860,13717,2.2
+12.80,851,99378,1.6
+0.50,834,9672,0.4
-0.32,831,65819,0.3
-1.93,807,182668,0.6
+11.22,801,12977,4.0
+0.06,793,39175,0.5
-0.92,792,65731,0.4
0.00,786,257496,0.8
-1.12,784,42720,0.6
+1.19,778,43044,0.9
+5.13,775,6188,3.2
+1.54,749,56041,1.0
-0.85,749,45355,0.7
-0.16,741,47849,0.6
+0.20,740,67420,0.5
"""

# CSV 또는 DataFrame으로 불러온 데이터라고 가정
df = pd.read_csv(StringIO(data))

# 회전율 (거래대금 / 유통총액)
df["turnover"] = np.log(df["거래대금"] / df["유통총액"])

# 설명변수와 종속변수
X = df[["turnover", "전일대비거래량"]]
y = df["등락률"]

# 절편 추가
X = sm.add_constant(X)

# 회귀분석 (OLS)
model = sm.OLS(y, X).fit()
print(model.summary())
